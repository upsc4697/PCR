<!DOCTYPE html>
<html>
<head>
  <title>Product Entry Form</title>
  <style>
    body { font-family: Arial; max-width: 500px; margin: auto; }
    input, textarea { width: 100%; margin: 8px 0; padding: 8px; }
    .itemRow { display: flex; gap: 10px; margin-bottom: 8px; }
    .itemRow input { flex: 1; }
    button { padding: 10px 15px; }
  </style>
</head>
<body>

  <h2>Product Entry Form</h2>
  <form id="productForm">
    <input name="product" placeholder="Product Name" required>

<div class="itemRow">
  <input name="item" placeholder="Item" required>
  <input name="weight" type="number" step="0.001" placeholder="Weight" required>
</div>

    <button type="button" onclick="addRow()">+ Add More Items</button><br><br>

    <input name="pantone" placeholder="Pantone">
    <input name="ral" placeholder="RAL">
    <input name="application" placeholder="Application">
    <textarea name="additional" placeholder="Additional Information"></textarea>

    <button type="submit">Submit</button>
  </form>

  <script>
    function addRow() {
      const div = document.createElement('div');
      div.className = 'itemRow';
      div.innerHTML = `
  <input name="item" placeholder="Item" required>
  <input name="weight" type="number" step="0.001" placeholder="Weight" required>
`;
      document.getElementById('items').appendChild(div);
    }

    document.getElementById('productForm').addEventListener('submit', function(e) {
      e.preventDefault();

      const form = e.target;
      const formData = new FormData(form);

      const product = formData.get('product');
      const pantone = formData.get('pantone');
      const ral = formData.get('ral');
      const application = formData.get('application');
      const additional = formData.get('additional');

      const items = Array.from(document.getElementsByName('item')).map(input => input.value);
      const weights = Array.from(document.getElementsByName('weight')).map(input => input.value);

      const data = new FormData();
      data.append('product', product);
      data.append('items', JSON.stringify(items));
      data.append('weights', JSON.stringify(weights));
      data.append('pantone', pantone);
      data.append('ral', ral);
      data.append('application', application);
      data.append('additional', additional);

      const scriptURL = 'https://script.google.com/macros/s/AKfycbwmMuQD2g_rRBMCLZnX_tEKhzMM37fOPspQyFc96nUebVVZ1q-q_hOB86CByEuYLu8o-A/exec';

      fetch(scriptURL, { method: 'POST', body: data })
        .then(response => alert("Submitted Successfully!"))
        .catch(error => alert("Error: " + error.message));
    });
  </script>

</body>
</html>
