<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Product Entry Form</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body {
      font-family: sans-serif;
      padding: 20px;
    }
    label {
      display: block;
      margin-top: 10px;
    }
    input, textarea {
      width: 100%;
      padding: 8px;
      margin-top: 4px;
    }
    button {
      margin-top: 15px;
      padding: 10px;
      background: green;
      color: white;
      border: none;
    }
    .item-pair {
      display: flex;
      gap: 10px;
      margin-top: 10px;
    }
    .item-pair input {
      flex: 1;
    }
  </style>
</head>
<body>

  <h2>Product Entry Form</h2>

  <form id="entryForm">
    <label>Product Name
      <input type="text" name="productName" required>
    </label>
    <label>Product Code
      <input type="text" name="productCode" required>
    </label>

    <div id="itemList">
      <div class="item-pair">
        <input type="text" placeholder="Item" name="item">
        <input type="number" placeholder="Weight" name="weight">
      </div>
    </div>
    <button type="button" onclick="addItem()">+ Add Item</button>

    <label>Pantone Code
      <input type="text" name="pantoneCode">
    </label>
    <label>RAL Code
      <input type="text" name="ralCode">
    </label>
    <label>Total Weight
      <input type="number" name="totalWeight" required>
    </label>
    <label>Application
      <input type="text" name="application">
    </label>
    <label>Additional Info
      <textarea name="additionalInfo"></textarea>
    </label>

    <button type="submit">Submit</button>
    <p id="statusMsg"></p>
  </form>

  <script>
    const scriptURL = 'https://script.google.com/macros/s/AKfycbxTbnfqDrmq_Nee7TjH2bNIVH0TiOsE79D1irRmAtdCOaYfsPOx3wg24vOo0EG2Ud5bFg/exec';

    const form = document.getElementById('entryForm');
    const statusMsg = document.getElementById('statusMsg');

    function addItem() {
      const div = document.createElement('div');
      div.className = 'item-pair';
      div.innerHTML = `
        <input type="text" placeholder="Item" name="item">
        <input type="number" placeholder="Weight" name="weight">
      `;
      document.getElementById('itemList').appendChild(div);
    }

    form.addEventListener('submit', (e) => {
      e.preventDefault();

      const data = new FormData(form);
      const items = [];
      const weights = [];

      document.querySelectorAll('input[name="item"]').forEach(i => items.push(i.value));
      document.querySelectorAll('input[name="weight"]').forEach(w => weights.push(w.value));

      const payload = {
        productName: data.get("productName"),
        productCode: data.get("productCode"),
        items,
        weights,
        pantoneCode: data.get("pantoneCode"),
        ralCode: data.get("ralCode"),
        totalWeight: data.get("totalWeight"),
        application: data.get("application"),
        additionalInfo: data.get("additionalInfo")
      };

      fetch(scriptURL, {
        method: 'POST',
        body: JSON.stringify(payload),
        headers: {
          'Content-Type': 'application/json'
        }
      })
      .then(response => response.text())
      .then(msg => {
        statusMsg.textContent = "✅ Submitted successfully!";
        form.reset();
        document.getElementById('itemList').innerHTML = `
          <div class="item-pair">
            <input type="text" placeholder="Item" name="item">
            <input type="number" placeholder="Weight" name="weight">
          </div>`;
      })
      .catch(err => {
        console.error(err);
        statusMsg.textContent = "❌ Submission failed. Try again.";
      });
    });
  </script>

</body>
</html>
